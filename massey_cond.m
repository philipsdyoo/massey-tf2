%We check the condition numbers of the Massey matrices
%Massey Method with Kawaii Five-0 and forfeited matches removed
W1 = [
    0	0	0	0	0	0	1	-1;
    0	0	0	0	0	1	0	-1;
    1	0	0	0	-1	0	0	0;
    -1	1	0	0	0	0	0	0;
    0	0	-1	1	0	0	0	0;
    0	1	0	-1	0	0	0	0
];
D1 = [4; 5; 2; 2; 1; 5];
W2 = [
    0	0	0	1	0	0	-1	0;
    0	0	0	-1	0	1	0	0;
    1	0	-1	0	0	0	0	0;
    0	1	0	0	-1	0	0	0;
    1	0	0	0	0	0	-1	0   
];
D2 = [1; 5; 5; 3; 3];
W3 = [
    0	0	0	0	1	-1	0	0;
    1	0	0	0	0	0	0	-1;
    1	0	0	0	0	-1	0	0;
    0	0	0	0	1	0	-1	0;
    0	1	-1	0	0	0	0	0;
    0	1	0	0	0	0	-1	0;
    0	0	0	1	0	0	0	-1   
];
D3 = [5; 5; 1; 5; 3; 2; 2];
W4 = [
    0	1	0	0	0	0	0	-1;
    0	0	0	0	1	0	0	-1;
    1	0	0	-1	0	0	0	0;
    0	0	1	0	0	-1	0	0;
    0	0	1	0	0	0	-1	0
];
D4 = [5; 2; 2; 3; 2];
W5 = [
    0	0	1	0	0	0	0	-1;
    0	0	0	0	0	-1	1	0;
    0	0	0	1	-1	0	0	0;
    1	0	0	0	-1	0	0	0;
    0	0	0	0	0	0	1	-1
];
D5 = [3; 3; 1; 4; 3];
W6 = [
    0	1	0	0	-1	0	0	0;
    -1	0	1	0	0	0	0	0;
    0	0	0	1	0	0	-1	0;
    1	-1	0	0	0	0	0	0;
    0	0	0	0	0	1	0	-1
];
D6 = [5; 3; 1; 1; 4];
W7 = [
    0	1	-1	0	0	0	0	0;
    0	0	0	1	0	-1	0	0;
    1	0	0	0	0	0	-1	0;
    0	0	1	0	-1	0	0	0;
    0	0	0	1	0	0	0	-1;
    0	0	0	0	-1	0	1	0;
    1	0	0	0	0	-1	0	0
];
D7 = [4; 2; 5; 2; 4; 2; 5];
W8 = [
    0	0	1	0	0	0	-1	0;
    0	0	0	0	1	-1	0	0;
];
D8 = [2; 4];
W9 = [
    1	0	0	-1	0	0	0	0;
    0	0	0	0	0	1	-1	0;
    0	0	1	0	0	-1	0	0
];
D9 = [5; 4; 1];
W = [W1; W2; W3; W4; W5; W6; W7; W8; W9];
D = [D1; D2; D3; D4; D5; D6; D7; D8; D9];
%disp(size(W));
%disp(size(D));
WT = transpose(W);
M = WT*W;
B = WT*D;

%Condition number before the "cheat" step
disp(cond(M));

ones = [1 1 1 1 1 1 1 1];
M(8,:)=ones;
B(8) = 0;

%Condition number after the "cheat" step
disp(cond(M));

%disp(M);
%disp(B);
R = M\B;
%disp(R);